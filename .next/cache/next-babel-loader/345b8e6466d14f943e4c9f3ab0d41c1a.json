{"ast":null,"code":"import _Date$now from \"@babel/runtime-corejs2/core-js/date/now\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport queryString from 'query-string';\nimport _isArray from 'lodash-es/isArray';\n\nvar ResourceComponent =\n/*#__PURE__*/\nfunction () {\n  function ResourceComponent() {\n    _classCallCheck(this, ResourceComponent);\n\n    this.googleApiKey = '';\n    this.googleCaptchaSiteKey = '';\n    this._callbacks = {};\n  }\n\n  _createClass(ResourceComponent, [{\n    key: \"loadGoogleMapApi\",\n    value: function loadGoogleMapApi() {\n      var locale = require('components').locale;\n\n      if (window.google && window.google.maps) {\n        return _Promise.resolve(window.google.maps);\n      }\n\n      return this.loadScript(ResourceComponent.RESOURCE_GOOGLE_MAP_API, {\n        libraries: 'places',\n        key: this.googleApiKey,\n        language: locale.language\n      }, function () {\n        return window.google.maps;\n      });\n    }\n  }, {\n    key: \"loadYandexMap\",\n    value: function loadYandexMap() {\n      var locale = require('components').locale;\n\n      if (window.ymaps) {\n        return new _Promise(function (resolve) {\n          return window.ymaps.ready(function () {\n            return resolve(window.ymaps);\n          });\n        });\n      }\n\n      return this.loadScript(ResourceComponent.RESOURCE_YANDEX_MAP_API, {\n        lang: locale.language\n      }, function () {\n        return new _Promise(function (resolve) {\n          return window.ymaps.ready(function () {\n            return resolve(window.ymaps);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"loadTwitterWidget\",\n    value: function loadTwitterWidget() {\n      if (window.twttr) {\n        return _Promise.resolve(window.twttr);\n      }\n\n      return this.loadScript(ResourceComponent.RESOURCE_TWITTER_WIDGET, {}, function () {\n        return new _Promise(function (resolve) {\n          return window.twttr.ready(function () {\n            return resolve(window.twttr);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"loadGeetest\",\n    value: function loadGeetest() {\n      if (window.initGeetest) {\n        return _Promise.resolve(window.initGeetest);\n      }\n\n      return this.loadScript(ResourceComponent.RESOURCE_GEETEST_API + '?_t=' + new Date().getTime(), {}, function () {\n        return window.initGeetest;\n      });\n    }\n  }, {\n    key: \"loadScript\",\n    value: function loadScript(url, params, firstResolver) {\n      var _this = this;\n\n      if (this._callbacks[url] === true) {\n        return _Promise.resolve(firstResolver());\n      }\n\n      if (_isArray(this._callbacks[url])) {\n        return new _Promise(function (resolve) {\n          _this._callbacks[url].push(resolve);\n        });\n      }\n\n      this._callbacks[url] = []; // Append script to page\n\n      return new _Promise(function (resolve, reject) {\n        var script = document.createElement('script');\n        script.async = true;\n\n        script.onload = function () {\n          setTimeout(function () {\n            _Promise.resolve(firstResolver()).then(function (result) {\n              // Resolve current\n              resolve(result); // Resolve queue promises after current\n\n              var callbacks = _this._callbacks[url];\n              _this._callbacks[url] = true;\n              callbacks.forEach(function (callback) {\n                return callback(result);\n              });\n            })[\"catch\"](reject);\n          });\n        };\n\n        script.src = url + (params ? '?' + queryString.stringify(params) : '');\n        document.body.appendChild(script);\n      });\n    }\n  }, {\n    key: \"wait\",\n    value: function wait(condition) {\n      var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n\n      var start = _Date$now();\n\n      var checker = function checker(resolve, reject) {\n        var result = condition();\n\n        if (result) {\n          resolve(result);\n        } else if (start + timeout > _Date$now()) {\n          reject();\n        } else {\n          setTimeout(function () {\n            return checker(resolve, reject);\n          }, 500);\n        }\n      };\n\n      return new _Promise(checker);\n    }\n  }]);\n\n  return ResourceComponent;\n}();\n\n_defineProperty(ResourceComponent, \"RESOURCE_GOOGLE_MAP_API\", '//maps.googleapis.com/maps/api/js');\n\n_defineProperty(ResourceComponent, \"RESOURCE_YANDEX_MAP_API\", 'https://api-maps.yandex.ru/2.1/');\n\n_defineProperty(ResourceComponent, \"RESOURCE_TWITTER_WIDGET\", 'https://platform.twitter.com/widgets.js');\n\n_defineProperty(ResourceComponent, \"RESOURCE_GEETEST_API\", '//static.geetest.com/static/tools/gt.js');\n\nexport { ResourceComponent as default };","map":null,"metadata":{},"sourceType":"module"}