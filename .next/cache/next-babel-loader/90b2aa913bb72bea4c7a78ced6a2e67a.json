{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _get from 'lodash-es/get';\nimport { FIELDS_BEFORE_FETCH, FIELDS_AFTER_FETCH, FIELDS_SET_META, FIELDS_ADD_SECURITY, FIELDS_REMOVE_SECURITY, normalizeName } from '../actions/fields';\nvar initialState = {\n  props: {},\n  security: {},\n  meta: null\n};\nexport default (function () {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case FIELDS_BEFORE_FETCH:\n      return _objectSpread({}, state, {\n        props: _objectSpread({}, state.props, _defineProperty({}, action.fieldId, _objectSpread({\n          props: null\n        }, state[action.fieldId], {\n          model: action.model,\n          attribute: action.attribute,\n          isLoading: true\n        })))\n      });\n\n    case FIELDS_AFTER_FETCH:\n      action.fields.forEach(function (field) {\n        state.props[field.fieldId] = _objectSpread({}, state[field.fieldId], {\n          isLoading: false,\n          props: _objectSpread({}, _get(state, \"\".concat(field.fieldId, \".props\")), {}, field.props)\n        });\n      });\n      return _objectSpread({}, state, {\n        props: _objectSpread({}, state.props)\n      });\n\n    case FIELDS_ADD_SECURITY:\n      return _objectSpread({}, state, {\n        security: _objectSpread({}, state.security, _defineProperty({}, action.formId, action.params))\n      });\n\n    case FIELDS_REMOVE_SECURITY:\n      return _objectSpread({}, state, {\n        security: _objectSpread({}, state.security, _defineProperty({}, action.formId, null))\n      });\n\n    case FIELDS_SET_META:\n      _Object$keys(action.meta).forEach(function (name) {\n        action.meta[name].className = name;\n      });\n\n      return _objectSpread({}, state, {\n        meta: _objectSpread({}, state.meta, {}, action.meta)\n      });\n  }\n\n  return state;\n});\nexport var getFieldProps = function getFieldProps(state, fieldId) {\n  return _get(state, ['fields', 'props', fieldId, 'props']);\n};\nexport var isFieldLoading = function isFieldLoading(state, fieldId) {\n  return !!_get(state, ['fields', 'props', fieldId, 'isLoading']);\n};\nexport var isMetaFetched = function isMetaFetched(state) {\n  return _get(state, ['fields', 'meta']) !== null;\n};\nexport var getEnumLabels = function getEnumLabels(state, name) {\n  return _get(state, ['fields', 'meta', name, 'labels']) || null;\n};\nexport var getSecurity = function getSecurity(state, formId) {\n  return _get(state, ['fields', 'security', formId]);\n};\nvar warnings = {};\nexport var getMeta = function getMeta(state, name) {\n  name = normalizeName(name);\n  var meta = _get(state, ['fields', 'meta', name]) || null;\n\n  if (!meta && isMetaFetched(state) && !warnings[name]) {\n    warnings[name] = true;\n    console.warn('Steroids: Not found model meta:', name);\n  }\n\n  return meta;\n};","map":{"version":3,"sources":["/usr/local/var/www/neutrino-web/node_modules/yii-steroids/reducers/fields.js"],"names":["_get","FIELDS_BEFORE_FETCH","FIELDS_AFTER_FETCH","FIELDS_SET_META","FIELDS_ADD_SECURITY","FIELDS_REMOVE_SECURITY","normalizeName","initialState","props","security","meta","state","action","type","fieldId","model","attribute","isLoading","fields","forEach","field","formId","params","name","className","getFieldProps","isFieldLoading","isMetaFetched","getEnumLabels","getSecurity","warnings","getMeta","console","warn"],"mappings":"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","sourcesContent":["import _get from 'lodash-es/get';\n\nimport {FIELDS_BEFORE_FETCH, FIELDS_AFTER_FETCH, FIELDS_SET_META, FIELDS_ADD_SECURITY, FIELDS_REMOVE_SECURITY, normalizeName} from '../actions/fields';\n\nconst initialState = {\n    props: {},\n    security: {},\n    meta: null,\n};\n\nexport default (state = initialState, action) => {\n    switch (action.type) {\n        case FIELDS_BEFORE_FETCH:\n            return {\n                ...state,\n                props: {\n                    ...state.props,\n                    [action.fieldId]: {\n                        props: null,\n                        ...state[action.fieldId],\n                        model: action.model,\n                        attribute: action.attribute,\n                        isLoading: true,\n                    },\n                },\n            };\n\n        case FIELDS_AFTER_FETCH:\n            action.fields.forEach(field => {\n                state.props[field.fieldId] = {\n                    ...state[field.fieldId],\n                    isLoading: false,\n                    props: {\n                        ..._get(state, `${field.fieldId}.props`),\n                        ...field.props,\n                    },\n                };\n            });\n            return {\n                ...state,\n                props: {\n                    ...state.props,\n                },\n            };\n\n        case FIELDS_ADD_SECURITY:\n            return {\n                ...state,\n                security: {\n                    ...state.security,\n                    [action.formId]: action.params,\n                },\n            };\n\n        case FIELDS_REMOVE_SECURITY:\n            return {\n                ...state,\n                security: {\n                    ...state.security,\n                    [action.formId]: null,\n                },\n            };\n\n        case FIELDS_SET_META:\n            Object.keys(action.meta).forEach(name => {\n                action.meta[name].className = name;\n            });\n\n            return {\n                ...state,\n                meta: {\n                    ...state.meta,\n                    ...action.meta,\n                },\n            };\n    }\n\n    return state;\n};\n\nexport const getFieldProps = (state, fieldId) => _get(state, ['fields', 'props', fieldId, 'props']);\nexport const isFieldLoading = (state, fieldId) => !!_get(state, ['fields', 'props', fieldId, 'isLoading']);\nexport const isMetaFetched = state => _get(state, ['fields', 'meta']) !== null;\nexport const getEnumLabels = (state, name) => _get(state, ['fields', 'meta', name, 'labels']) || null;\nexport const getSecurity = (state, formId) => _get(state, ['fields', 'security', formId]);\n\nconst warnings = {};\nexport const getMeta = (state, name) => {\n    name = normalizeName(name);\n\n    const meta = _get(state, ['fields', 'meta', name]) || null;\n    if (!meta && isMetaFetched(state) && !warnings[name]) {\n        warnings[name] = true;\n        console.warn('Steroids: Not found model meta:', name);\n    }\n    return meta;\n};\n"]},"metadata":{},"sourceType":"module"}