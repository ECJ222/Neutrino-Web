{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _Array$isArray from \"@babel/runtime-corejs2/core-js/array/is-array\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createStore, applyMiddleware, compose } from 'redux';\nimport { routerMiddleware } from 'react-router-redux';\nimport { createBrowserHistory, createMemoryHistory } from 'history';\nimport _get from 'lodash-es/get';\nimport _merge from 'lodash-es/merge';\nimport _isPlainObject from 'lodash-es/isPlainObject';\nimport reducers from 'reducers';\n\nvar StoreComponent =\n/*#__PURE__*/\nfunction () {\n  function StoreComponent() {\n    var lazyInit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    _classCallCheck(this, StoreComponent);\n\n    this.history = null;\n    this.store = null;\n    this._asyncReducers = {};\n\n    if (!lazyInit) {\n      this.initStore();\n    }\n  }\n\n  _createClass(StoreComponent, [{\n    key: \"init\",\n    value: function init() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.initStore(config);\n      this.configurate();\n    }\n  }, {\n    key: \"initStore\",\n    value: function initStore() {\n      var _this = this;\n\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var initialState = _objectSpread({}, !process.env.IS_NODE ? _merge.apply(void 0, _toConsumableArray(window.APP_REDUX_PRELOAD_STATES || [{}])) : {}, {}, config.initialState);\n\n      var createHistory = process.env.IS_NODE ? createMemoryHistory : createBrowserHistory;\n      this.history = createHistory(_objectSpread({}, _get(initialState, 'config.store.history', {}), {}, config.history));\n      this.store = createStore(reducers(), initialState, compose(applyMiddleware(function (_ref) {\n        var getState = _ref.getState;\n        return function (next) {\n          return function (action) {\n            return _this._prepare(action, next, getState);\n          };\n        };\n      }), applyMiddleware(routerMiddleware(this.history)), window.__REDUX_DEVTOOLS_EXTENSION__ ? window.__REDUX_DEVTOOLS_EXTENSION__() : function (f) {\n        return f;\n      }));\n    }\n  }, {\n    key: \"configurate\",\n    value: function configurate() {\n      // Apply configuration\n      var customConfig = this.getState().config || {};\n\n      var components = require('components');\n\n      _merge(components.clientStorage, customConfig.clientStorage);\n\n      _merge(components.html, customConfig.html);\n\n      _merge(components.http, customConfig.http);\n\n      _merge(components.locale, customConfig.locale);\n\n      _merge(components.resource, customConfig.resource);\n\n      _merge(components.store, customConfig.store);\n\n      _merge(components.ui, customConfig.ui);\n\n      _merge(components.widget, customConfig.widget);\n    }\n  }, {\n    key: \"dispatch\",\n    value: function dispatch(action) {\n      return this.store.dispatch(action);\n    }\n  }, {\n    key: \"getState\",\n    value: function getState() {\n      return this.store.getState();\n    }\n  }, {\n    key: \"addReducers\",\n    value: function addReducers(asyncReducers) {\n      this._asyncReducers = _objectSpread({}, this._asyncReducers, {}, asyncReducers);\n      this.store.replaceReducer(reducers(this._asyncReducers));\n    }\n  }, {\n    key: \"errorHandler\",\n    value: function errorHandler(error) {\n      throw error;\n    }\n  }, {\n    key: \"_prepare\",\n    value: function _prepare(action, dispatch, getState) {\n      var _this2 = this;\n\n      // Multiple dispatch (redux-multi)\n      if (_Array$isArray(action)) {\n        return action.filter(function (v) {\n          return v;\n        }).map(function (p) {\n          return _this2._prepare(p, dispatch, getState);\n        });\n      } // Function wraper (redux-thunk)\n\n\n      if (typeof action === 'function') {\n        return action(function (p) {\n          return _this2._prepare(p, dispatch, getState);\n        }, getState);\n      } // Promise, detect errors on rejects\n      // Detect action through instanceof Promise is not working in production mode, then used single detection by type\n\n\n      if (typeof action === 'object' && typeof action.then === 'function' && typeof action[\"catch\"] === 'function') {\n        return action.then(function (payload) {\n          return _this2._prepare(payload, dispatch, getState);\n        })[\"catch\"](function (e) {\n          _this2.errorHandler(e, function (p) {\n            return _this2._prepare(p, dispatch, getState);\n          });\n        });\n      } // Default case\n\n\n      if (_isPlainObject(action) && action.type) {\n        if (process.env.NODE_ENV !== 'production') {\n          window.__snapshot = (window.__snapshot || []).concat({\n            action: action\n          });\n        }\n\n        try {\n          return dispatch(action);\n        } catch (e) {\n          this.errorHandler(e, function (p) {\n            return _this2._prepare(p, dispatch, getState);\n          });\n        }\n      }\n\n      return action;\n    }\n  }]);\n\n  return StoreComponent;\n}();\n\nexport { StoreComponent as default };","map":{"version":3,"sources":["/usr/local/var/www/neutrino-web/node_modules/yii-steroids/components/StoreComponent.js"],"names":["createStore","applyMiddleware","compose","routerMiddleware","createBrowserHistory","createMemoryHistory","_get","_merge","_isPlainObject","reducers","StoreComponent","lazyInit","history","store","_asyncReducers","initStore","config","configurate","initialState","process","env","IS_NODE","window","APP_REDUX_PRELOAD_STATES","createHistory","getState","next","action","_prepare","__REDUX_DEVTOOLS_EXTENSION__","f","customConfig","components","require","clientStorage","html","http","locale","resource","ui","widget","dispatch","asyncReducers","replaceReducer","error","filter","v","map","p","then","payload","e","errorHandler","type","NODE_ENV","__snapshot","concat"],"mappings":"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","sourcesContent":["import {createStore, applyMiddleware, compose} from 'redux';\nimport {routerMiddleware} from 'react-router-redux';\nimport {createBrowserHistory, createMemoryHistory} from 'history';\nimport _get from 'lodash-es/get';\nimport _merge from 'lodash-es/merge';\nimport _isPlainObject from 'lodash-es/isPlainObject';\n\nimport reducers from 'reducers';\n\nexport default class StoreComponent {\n\n    constructor(lazyInit = false) {\n        this.history = null;\n        this.store = null;\n        this._asyncReducers = {};\n\n        if (!lazyInit) {\n            this.initStore();\n        }\n    }\n\n    init(config = {}) {\n        this.initStore(config);\n        this.configurate();\n    }\n\n    initStore(config = {}) {\n        const initialState = {\n            ...(!process.env.IS_NODE ? _merge(...(window.APP_REDUX_PRELOAD_STATES || [{}])) : {}),\n            ...config.initialState,\n        };\n        const createHistory = process.env.IS_NODE ? createMemoryHistory : createBrowserHistory;\n        this.history = createHistory({\n            ..._get(initialState, 'config.store.history', {}),\n            ...config.history\n        });\n        this.store = createStore(\n            reducers(),\n            initialState,\n            compose(\n                applyMiddleware(({getState}) => next => action => this._prepare(action, next, getState)),\n                applyMiddleware(routerMiddleware(this.history)),\n                window.__REDUX_DEVTOOLS_EXTENSION__ ? window.__REDUX_DEVTOOLS_EXTENSION__() : f => f\n            )\n        );\n    }\n\n    configurate() {\n        // Apply configuration\n        const customConfig = this.getState().config || {};\n        const components = require('components');\n        _merge(components.clientStorage, customConfig.clientStorage);\n        _merge(components.html, customConfig.html);\n        _merge(components.http, customConfig.http);\n        _merge(components.locale, customConfig.locale);\n        _merge(components.resource, customConfig.resource);\n        _merge(components.store, customConfig.store);\n        _merge(components.ui, customConfig.ui);\n        _merge(components.widget, customConfig.widget);\n    }\n\n    dispatch(action) {\n        return this.store.dispatch(action);\n    }\n\n    getState() {\n        return this.store.getState();\n    }\n\n    addReducers(asyncReducers) {\n        this._asyncReducers = {\n            ...this._asyncReducers,\n            ...asyncReducers,\n        };\n\n        this.store.replaceReducer(reducers(this._asyncReducers));\n    }\n\n    errorHandler(error) {\n        throw error;\n    }\n\n    _prepare(action, dispatch, getState) {\n        // Multiple dispatch (redux-multi)\n        if (Array.isArray(action)) {\n            return action.filter(v => v).map(p => this._prepare(p, dispatch, getState));\n        }\n\n        // Function wraper (redux-thunk)\n        if (typeof action === 'function') {\n            return action(p => this._prepare(p, dispatch, getState), getState);\n        }\n\n        // Promise, detect errors on rejects\n        // Detect action through instanceof Promise is not working in production mode, then used single detection by type\n        if (typeof action === 'object' && typeof action.then === 'function' && typeof action.catch === 'function') {\n            return action\n                .then(payload => this._prepare(payload, dispatch, getState))\n                .catch(e => {\n                    this.errorHandler(e, p => this._prepare(p, dispatch, getState));\n                });\n        }\n\n        // Default case\n        if (_isPlainObject(action) && action.type) {\n            if (process.env.NODE_ENV !== 'production') {\n                window.__snapshot = (window.__snapshot || []).concat({action});\n            }\n\n            try {\n                return dispatch(action);\n            } catch (e) {\n                this.errorHandler(e, p => this._prepare(p, dispatch, getState));\n            }\n        }\n\n        return action;\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}